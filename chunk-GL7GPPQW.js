import{n as g}from"./chunk-HAXKXQNK.js";import{Ba as u,Ea as T,I as c,da as m,ia as h,n as i,ta as d}from"./chunk-7LOXSSZQ.js";var p=class a{document=h(d);meta=h(g);currentTheme=u("system");constructor(){let e=localStorage.getItem("theme");e&&this.currentTheme.set(e),T(()=>{let r=this.currentTheme();this.applyTheme(r),localStorage.setItem("theme",r)}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{this.currentTheme()==="system"&&this.applyTheme("system")})}toggleTheme(){let e=this.currentTheme();if(e==="light")this.currentTheme.set("dark");else if(e==="dark")this.currentTheme.set("light");else{let t=window.matchMedia("(prefers-color-scheme: dark)").matches;this.currentTheme.set(t?"light":"dark")}}setTheme(e){this.currentTheme.set(e)}applyTheme(e){let t=this.document.body;t.classList.remove("light-theme","dark-theme");let r;e==="system"?r=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":r=e,t.classList.add(`${r}-theme`);let n=r==="dark"?"#1e1e1e":"#ffffff";this.meta.updateTag({name:"theme-color",content:n})}static \u0275fac=function(t){return new(t||a)};static \u0275prov=m({token:a,factory:a.\u0275fac,providedIn:"root"})};var f=class a{CUSTOMER_KEY="khatabook_customers";TRANSACTION_KEY="khatabook_transactions";constructor(){}getCustomers(){let e=localStorage.getItem(this.CUSTOMER_KEY),t=e?JSON.parse(e):[];return i(t).pipe(c(300))}saveCustomers(e){return localStorage.setItem(this.CUSTOMER_KEY,JSON.stringify(e)),i(!0).pipe(c(200))}getTransactions(){let e=localStorage.getItem(this.TRANSACTION_KEY),t=e?JSON.parse(e):[];return i(t).pipe(c(300))}saveTransactions(e){return localStorage.setItem(this.TRANSACTION_KEY,JSON.stringify(e)),i(!0).pipe(c(200))}clearData(){localStorage.removeItem(this.CUSTOMER_KEY),localStorage.removeItem(this.TRANSACTION_KEY)}getFullData(){let e=localStorage.getItem(this.CUSTOMER_KEY),t=localStorage.getItem(this.TRANSACTION_KEY);return{customers:e?JSON.parse(e):[],transactions:t?JSON.parse(t):[]}}importFullData(e){let t=0,r=0,n=this.getFullData();if(e.customers&&Array.isArray(e.customers)){let l=new Set(n.customers.map(s=>s.id)),o=e.customers.filter(s=>!l.has(s.id));if(o.length>0){let s=[...n.customers,...o];localStorage.setItem(this.CUSTOMER_KEY,JSON.stringify(s)),t=o.length}}if(e.transactions&&Array.isArray(e.transactions)){let l=new Set(n.transactions.map(s=>s.id)),o=e.transactions.filter(s=>!l.has(s.id));if(o.length>0){let s=[...n.transactions,...o];localStorage.setItem(this.TRANSACTION_KEY,JSON.stringify(s)),r=o.length}}return{addedCustomers:t,addedTransactions:r}}static \u0275fac=function(t){return new(t||a)};static \u0275prov=m({token:a,factory:a.\u0275fac,providedIn:"root"})};export{p as a,f as b};
