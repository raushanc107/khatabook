import{B as Hn,C as uo,D as po,E as mo,F as fo,K as ho,l as Bn,m as Un,n as Ne,o as $n,p as zn,q as Kn,r as Fe}from"./chunk-HSPFZP3F.js";import{a as go,b as vo}from"./chunk-HF6EIVSA.js";import{$a as Wn,A as xn,B as Pn,C as An,D as lt,E as Re,F as kn,G as oe,H as Dn,J as Rn,N as Nn,P as Fn,S as jn,Ua as Vn,W as Ln,Wa as Yn,Xa as je,Za as Le,_a as Gn,ab as Be,bb as Jn,c as fn,cb as Zn,d as te,db as Ue,eb as Xn,f as hn,fb as Qn,g as gn,gb as dt,h as vn,hb as qn,i as yn,ib as eo,j as ne,jb as to,k as Cn,kb as no,l as bn,lb as oo,m as Mn,mb as ro,n as On,nb as io,o as _n,q as Pe,qb as so,r as Ae,rb as ao,s as Sn,sb as co,t as En,tb as lo,u as ke,ub as $e,v as Tn,vb as ze,w as ct,x as De,y as wn,z as In}from"./chunk-FHRBXXK6.js";import{$ as ue,A as Z,Aa as Wt,Ac as un,B as I,Ba as Ie,Ca as Jt,D as ie,Dc as pn,E as Nt,Ea as Zt,Eb as on,Ec as mn,F as Ft,G as z,Gb as it,H as jt,I as Ce,Ia as Xt,J as Lt,Jc as at,L as Bt,O as ot,Ob as P,Pb as l,Q as Ut,Qa as Qt,Qb as u,Rb as R,T as $t,U as zt,W as Kt,X as Vt,Xb as xe,Y as X,Z as Se,_ as rt,a as D,aa as G,ac as A,b as re,ba as Yt,bb as qt,cc as me,da as E,db as g,dc as rn,ec as sn,f as H,g as ce,ga as j,gc as an,ha as S,hb as en,hc as cn,i as xt,ia as p,ic as ln,j as Pt,ja as Q,k as At,ka as Ht,kb as tn,l as kt,mc as st,n as F,nb as nn,nc as be,oa as q,oc as V,pa as ee,pc as dn,qc as m,r as Dt,rc as Y,s as C,sa as Ee,sb as K,sc as se,t as Rt,ta as Te,u as le,wa as Gt,xa as pe,ya as we,yb as W,yc as x,z as de,zc as k}from"./chunk-7LOXSSZQ.js";var nr="@",or=(()=>{class t{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=null;injector=p(Ee);loadingSchedulerFn=p(rr,{optional:!0});_engine;constructor(e,o,r,i,s){this.doc=e,this.delegate=o,this.zone=r,this.animationType=i,this.moduleImpl=s}ngOnDestroy(){this._engine?.flush()}loadImpl(){let e=()=>this.moduleImpl??import("./chunk-6JZLQAIR.js").then(r=>r),o;return this.loadingSchedulerFn?o=this.loadingSchedulerFn(e):o=e(),o.catch(r=>{throw new G(5300,!1)}).then(({\u0275createEngine:r,\u0275AnimationRendererFactory:i})=>{this._engine=r(this.animationType,this.doc);let s=new i(this.delegate,this._engine,this.zone);return this.delegate=s,s})}createRenderer(e,o){let r=this.delegate.createRenderer(e,o);if(r.\u0275type===0)return r;typeof r.throwOnSyntheticProps=="boolean"&&(r.throwOnSyntheticProps=!1);let i=new ut(r);return o?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(s=>{let c=s.createRenderer(e,o);i.use(c),this.scheduler??=this.injector.get(Jt,null,{optional:!0}),this.scheduler?.notify(10)}).catch(s=>{i.use(r)}),i}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}componentReplaced(e){this._engine?.flush(),this.delegate.componentReplaced?.(e)}static \u0275fac=function(o){nn()};static \u0275prov=E({token:t,factory:t.\u0275fac})}return t})(),ut=class{delegate;replay=[];\u0275type=1;constructor(n){this.delegate=n}use(n){if(this.delegate=n,this.replay!==null){for(let e of this.replay)e(n);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}get destroyNode(){return this.delegate.destroyNode}appendChild(n,e){this.delegate.appendChild(n,e)}insertBefore(n,e,o,r){this.delegate.insertBefore(n,e,o,r)}removeChild(n,e,o,r){this.delegate.removeChild(n,e,o,r)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,o,r){this.delegate.setAttribute(n,e,o,r)}removeAttribute(n,e,o){this.delegate.removeAttribute(n,e,o)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,o,r){this.delegate.setStyle(n,e,o,r)}removeStyle(n,e,o){this.delegate.removeStyle(n,e,o)}setProperty(n,e,o){this.shouldReplay(e)&&this.replay.push(r=>r.setProperty(n,e,o)),this.delegate.setProperty(n,e,o)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,o,r){return this.shouldReplay(e)&&this.replay.push(i=>i.listen(n,e,o,r)),this.delegate.listen(n,e,o,r)}shouldReplay(n){return this.replay!==null&&n.startsWith(nr)}},rr=new j("");function yo(t="animations"){return en("NgAsyncAnimations"),Q([{provide:tn,useFactory:()=>new or(p(Te),p(bn),p(pe),t)},{provide:Qt,useValue:t==="noop"?"NoopAnimations":"BrowserAnimations"}])}function ar(t,n){if(t&1){let e=xe();l(0,"div",18),A("click",function(){let r=q(e).$implicit,i=me();return ee(i.viewCustomer(r.id))}),l(1,"div",19),m(2),x(3,"uppercase"),u(),l(4,"div",20)(5,"h3",21),m(6),u(),l(7,"span",22),m(8),x(9,"date"),u()(),l(10,"div",23)(11,"span",4),m(12),x(13,"number"),u(),l(14,"span",24),m(15),u()()()}if(t&2){let e=n.$implicit;g(2),se(" ",k(3,9,e.name.charAt(0))," "),g(4),Y(e.name),g(2),Y(un(9,11,e.lastUpdated,"mediumDate")),g(2),V("positive",e.currentBalance>=0)("negative",e.currentBalance<0),g(2),se("\u20B9",k(13,14,e.currentBalance)),g(3),Y(e.currentBalance>=0?"You will get":"You will give")}}function cr(t,n){t&1&&(l(0,"div",25)(1,"p"),m(2,"No customers yet. Add one to start!"),u()())}var Ke=class t{store=p(oe);dialog=p(Ne);router=p(Ae);searchControl=new Fn("");customers$=Rt([this.store.select(so),this.searchControl.valueChanges.pipe(Vt(""))]).pipe(C(([n,e])=>{let o=(e||"").toLowerCase();return n.filter(r=>r.name.toLowerCase().includes(o)||r.phoneNumber.includes(o)).sort((r,i)=>new Date(i.lastUpdated).getTime()-new Date(r.lastUpdated).getTime())}));totalToGet$=this.store.select(ao);totalToGive$=this.store.select(co);netBalance$=this.store.select(lo);ngOnInit(){this.store.dispatch(Le()),this.store.dispatch(Ue())}addCustomer(){this.dialog.open(Hn,{width:"300px"}).afterClosed().subscribe(e=>{if(e&&e.name){let o={id:crypto.randomUUID(),name:e.name,phoneNumber:e.phoneNumber||"",currentBalance:0,lastUpdated:new Date().toISOString()};this.store.dispatch(Be({customer:o}))}})}viewCustomer(n){this.router.navigate(["customer",n])}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=K({type:t,selectors:[["app-customer-list"]],decls:42,vars:33,consts:[[1,"list-container"],[1,"summary-card","card"],[1,"summary-top"],[1,"label"],[1,"amount"],[1,"summary-bottom"],[1,"summary-item"],[1,"amount","text-success"],[1,"amount","text-danger"],[1,"search-bar"],["type","text","placeholder","Search Customer...",1,"search-input",3,"formControl"],[1,"customer-list-content"],[1,"list-header"],[1,"btn","btn-primary","btn-sm","desktop-only",3,"click"],[1,"customers"],["class","customer-item card",3,"click",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"fab",3,"click"],[1,"customer-item","card",3,"click"],[1,"customer-avatar"],[1,"customer-info"],[1,"customer-name"],[1,"last-updated"],[1,"customer-balance"],[1,"status"],[1,"empty-state"]],template:function(e,o){if(e&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),m(4,"Net Balance"),u(),l(5,"h2",4),x(6,"async"),x(7,"async"),m(8),x(9,"async"),x(10,"number"),u()(),l(11,"div",5)(12,"div",6)(13,"span",3),m(14,"You will get"),u(),l(15,"span",7),m(16),x(17,"async"),x(18,"number"),u()(),l(19,"div",6)(20,"span",3),m(21,"You will give"),u(),l(22,"span",8),m(23),x(24,"async"),x(25,"number"),u()()()(),l(26,"div",9),R(27,"input",10),u(),l(28,"div",11)(29,"div",12)(30,"span"),m(31),x(32,"async"),u(),l(33,"button",13),A("click",function(){return o.addCustomer()}),m(34,"+ Add Customer"),u()(),l(35,"div",14),W(36,ar,16,16,"div",15),x(37,"async"),W(38,cr,3,0,"div",16),x(39,"async"),u()(),l(40,"button",17),A("click",function(){return o.addCustomer()}),m(41,"+"),u()()),e&2){let r,i;g(5),V("positive",k(6,11,o.netBalance$)>=0)("negative",k(7,13,o.netBalance$)<0),g(3),se(" \u20B9",k(10,17,k(9,15,o.netBalance$))," "),g(8),se("\u20B9",k(18,21,k(17,19,o.totalToGet$))),g(7),se("\u20B9",k(25,25,k(24,23,o.totalToGive$))),g(4),P("formControl",o.searchControl),g(4),se("",(r=k(32,27,o.customers$))==null?null:r.length," Customers"),g(5),P("ngForOf",k(37,29,o.customers$)),g(2),P("ngIf",((i=k(39,31,o.customers$))==null?null:i.length)===0)}},dependencies:[ne,fn,te,Fe,Ln,Rn,Nn,jn,hn,gn,yn,vn],styles:[".list-container[_ngcontent-%COMP%]{padding:1rem;height:100%;overflow-y:auto;background-color:var(--background-color)}.summary-card[_ngcontent-%COMP%]{padding:0!important;margin-bottom:1.5rem;overflow:hidden}.summary-card[_ngcontent-%COMP%]   .summary-top[_ngcontent-%COMP%]{padding:1.25rem;text-align:center;border-bottom:1px solid var(--border-color)}.summary-card[_ngcontent-%COMP%]   .summary-top[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:block;font-size:.8rem;text-transform:uppercase;color:var(--text-secondary);margin-bottom:.5rem;letter-spacing:.05em}.summary-card[_ngcontent-%COMP%]   .summary-top[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{margin:0;font-size:1.75rem;font-weight:700}.summary-card[_ngcontent-%COMP%]   .summary-top[_ngcontent-%COMP%]   .amount.positive[_ngcontent-%COMP%]{color:var(--success-color)}.summary-card[_ngcontent-%COMP%]   .summary-top[_ngcontent-%COMP%]   .amount.negative[_ngcontent-%COMP%]{color:var(--danger-color)}.summary-card[_ngcontent-%COMP%]   .summary-bottom[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr}.summary-card[_ngcontent-%COMP%]   .summary-bottom[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{padding:1rem;text-align:center}.summary-card[_ngcontent-%COMP%]   .summary-bottom[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]:first-child{border-right:1px solid var(--border-color)}.summary-card[_ngcontent-%COMP%]   .summary-bottom[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:block;font-size:.75rem;color:var(--text-secondary);margin-bottom:.25rem}.summary-card[_ngcontent-%COMP%]   .summary-bottom[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600}.summary-card[_ngcontent-%COMP%]   .summary-bottom[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .amount.text-success[_ngcontent-%COMP%]{color:var(--success-color)}.summary-card[_ngcontent-%COMP%]   .summary-bottom[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .amount.text-danger[_ngcontent-%COMP%]{color:var(--danger-color)}.search-bar[_ngcontent-%COMP%]{margin-bottom:1rem}.search-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;border:1px solid var(--border-color);border-radius:.5rem;font-size:1rem;box-sizing:border-box}.search-bar[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px var(--primary-light)}.customer-list-content[_ngcontent-%COMP%]   .list-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem;color:var(--text-secondary);font-size:.875rem}.customer-list-content[_ngcontent-%COMP%]   .customers[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;padding-bottom:80px}.customer-list-content[_ngcontent-%COMP%]   .customer-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:1rem;cursor:pointer;transition:transform .1s,background-color .2s}.customer-list-content[_ngcontent-%COMP%]   .customer-item[_ngcontent-%COMP%]:hover{background-color:var(--hover-bg)}.customer-list-content[_ngcontent-%COMP%]   .customer-item[_ngcontent-%COMP%]:active{transform:scale(.99)}.customer-list-content[_ngcontent-%COMP%]   .customer-item[_ngcontent-%COMP%]   .customer-avatar[_ngcontent-%COMP%]{width:40px;height:40px;background-color:var(--primary-light);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:600;margin-right:1rem;flex-shrink:0}.customer-list-content[_ngcontent-%COMP%]   .customer-item[_ngcontent-%COMP%]   .customer-info[_ngcontent-%COMP%]{flex:1;min-width:0}.customer-list-content[_ngcontent-%COMP%]   .customer-item[_ngcontent-%COMP%]   .customer-info[_ngcontent-%COMP%]   .customer-name[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.customer-list-content[_ngcontent-%COMP%]   .customer-item[_ngcontent-%COMP%]   .customer-info[_ngcontent-%COMP%]   .last-updated[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-secondary)}.customer-list-content[_ngcontent-%COMP%]   .customer-item[_ngcontent-%COMP%]   .customer-balance[_ngcontent-%COMP%]{text-align:right;display:flex;flex-direction:column;flex-shrink:0}.customer-list-content[_ngcontent-%COMP%]   .customer-item[_ngcontent-%COMP%]   .customer-balance[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:600;font-size:1rem}.customer-list-content[_ngcontent-%COMP%]   .customer-item[_ngcontent-%COMP%]   .customer-balance[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{font-size:.65rem;color:var(--text-secondary)}.customer-list-content[_ngcontent-%COMP%]   .customer-item[_ngcontent-%COMP%]   .customer-balance.positive[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{color:var(--success-color)}.customer-list-content[_ngcontent-%COMP%]   .customer-item[_ngcontent-%COMP%]   .customer-balance.negative[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{color:var(--danger-color)}.fab[_ngcontent-%COMP%]{position:fixed;bottom:2rem;right:2rem;width:56px;height:56px;border-radius:50%;background-color:var(--primary-color);color:#fff;font-size:2rem;border:none;box-shadow:var(--shadow-lg);display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:100}.fab[_ngcontent-%COMP%]:hover{background-color:var(--primary-dark);transform:scale(1.05)}@media(min-width:768px){.fab[_ngcontent-%COMP%]{display:none}}.desktop-only[_ngcontent-%COMP%]{display:none}@media(min-width:768px){.desktop-only[_ngcontent-%COMP%]{display:inline-flex}}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:var(--text-secondary)}"]})};var Ye=class t{document=p(Te);meta=p(On);currentTheme=Ie("system");constructor(){let n=localStorage.getItem("theme");n&&this.currentTheme.set(n),Zt(()=>{let o=this.currentTheme();this.applyTheme(o),localStorage.setItem("theme",o)}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{this.currentTheme()==="system"&&this.applyTheme("system")})}toggleTheme(){let n=this.currentTheme();if(n==="light")this.currentTheme.set("dark");else if(n==="dark")this.currentTheme.set("light");else{let e=window.matchMedia("(prefers-color-scheme: dark)").matches;this.currentTheme.set(e?"light":"dark")}}setTheme(n){this.currentTheme.set(n)}applyTheme(n){let e=this.document.body;e.classList.remove("light-theme","dark-theme");let o;n==="system"?o=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":o=n,e.classList.add(`${o}-theme`);let r=o==="dark"?"#1e1e1e":"#ffffff";this.meta.updateTag({name:"theme-color",content:r})}static \u0275fac=function(e){return new(e||t)};static \u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})};var lr=["container"],dr=["*"];function ur(t,n){t&1&&R(0,"div",6)}function pr(t,n){if(t&1&&(l(0,"div",7),m(1,"\u2193"),u()),t&2){let e=me();be("transform","rotate("+e.currentY*2+"deg)")}}var He=class t{scrollable=!0;refresh=new Gt;container;startY=0;currentY=0;refreshing=!1;pullThreshold=80;onTouchStart(n){if(this.refreshing)return;let e=n.composedPath(),o=!1;for(let r of e)if(r instanceof HTMLElement){if(r.scrollTop>0){o=!0;break}if(r.classList.contains("content")&&r.scrollTop>0){o=!0;break}}o?this.startY=-1:this.startY=n.touches[0].pageY}onTouchMove(n){if(this.startY===-1||this.refreshing)return;let o=n.touches[0].pageY-this.startY;o>0&&(this.currentY=Math.pow(o,.85),this.currentY>0&&n.preventDefault())}onTouchEnd(){this.startY===-1||this.refreshing||(this.currentY>=this.pullThreshold?this.triggerRefresh():this.reset())}triggerRefresh(){this.refreshing=!0,this.refresh.emit(),setTimeout(()=>this.finishRefresh(),2e3)}finishRefresh(){this.refreshing=!1,this.reset()}reset(){this.currentY=0,this.startY=-1}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=K({type:t,selectors:[["app-pull-to-refresh"]],viewQuery:function(e,o){if(e&1&&an(lr,5),e&2){let r;cn(r=ln())&&(o.container=r.first)}},hostVars:6,hostBindings:function(e,o){e&1&&A("touchstart",function(i){return o.onTouchStart(i)})("touchmove",function(i){return o.onTouchMove(i)})("touchend",function(){return o.onTouchEnd()}),e&2&&be("display","block")("height","100vh")("width","100%")},inputs:{scrollable:"scrollable"},outputs:{refresh:"refresh"},ngContentSelectors:dr,decls:7,vars:12,consts:[["container",""],[1,"pull-to-refresh-container"],[1,"refresh-indicator"],["class","spinner",4,"ngIf"],["class","arrow",3,"transform",4,"ngIf"],[1,"content"],[1,"spinner"],[1,"arrow"]],template:function(e,o){e&1&&(rn(),l(0,"div",1,0)(2,"div",2),W(3,ur,1,0,"div",3)(4,pr,2,2,"div",4),u(),l(5,"div",5),sn(6),u()()),e&2&&(g(2),be("transform","translateY("+o.currentY+"px)"),V("refreshing",o.refreshing),g(),P("ngIf",o.refreshing),g(),P("ngIf",!o.refreshing&&o.currentY>20),g(),be("transform","translateY("+o.currentY+"px)")("overflow-y",o.scrollable?"auto":"visible"),V("refreshing",o.refreshing))},dependencies:[ne,te],styles:[".pull-to-refresh-container[_ngcontent-%COMP%]{position:relative;overflow:hidden;height:100%}.refresh-indicator[_ngcontent-%COMP%]{position:absolute;top:-50px;left:0;right:0;height:50px;display:flex;align-items:center;justify-content:center;z-index:100;transition:transform .1s ease-out;pointer-events:none}.refresh-indicator.refreshing[_ngcontent-%COMP%]{transform:translateY(60px)!important;transition:transform .3s ease-in-out}.content[_ngcontent-%COMP%]{height:100%;overflow-y:auto;transition:transform .1s ease-out;-webkit-overflow-scrolling:touch}.content.refreshing[_ngcontent-%COMP%]{transform:translateY(50px)!important;transition:transform .3s ease-in-out}.spinner[_ngcontent-%COMP%]{width:24px;height:24px;border:3px solid var(--primary-light);border-top:3px solid var(--primary-color);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.arrow[_ngcontent-%COMP%]{font-size:24px;color:var(--primary-color);font-weight:700}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})};var fe=class t{CUSTOMER_KEY="khatabook_customers";TRANSACTION_KEY="khatabook_transactions";constructor(){}getCustomers(){let n=localStorage.getItem(this.CUSTOMER_KEY),e=n?JSON.parse(n):[];return F(e).pipe(Ce(300))}saveCustomers(n){return localStorage.setItem(this.CUSTOMER_KEY,JSON.stringify(n)),F(!0).pipe(Ce(200))}getTransactions(){let n=localStorage.getItem(this.TRANSACTION_KEY),e=n?JSON.parse(n):[];return F(e).pipe(Ce(300))}saveTransactions(n){return localStorage.setItem(this.TRANSACTION_KEY,JSON.stringify(n)),F(!0).pipe(Ce(200))}clearData(){localStorage.removeItem(this.CUSTOMER_KEY),localStorage.removeItem(this.TRANSACTION_KEY)}getFullData(){let n=localStorage.getItem(this.CUSTOMER_KEY),e=localStorage.getItem(this.TRANSACTION_KEY);return{customers:n?JSON.parse(n):[],transactions:e?JSON.parse(e):[]}}importFullData(n){let e=0,o=0,r=this.getFullData();if(n.customers&&Array.isArray(n.customers)){let i=new Set(r.customers.map(c=>c.id)),s=n.customers.filter(c=>!i.has(c.id));if(s.length>0){let c=[...r.customers,...s];localStorage.setItem(this.CUSTOMER_KEY,JSON.stringify(c)),e=s.length}}if(n.transactions&&Array.isArray(n.transactions)){let i=new Set(r.transactions.map(c=>c.id)),s=n.transactions.filter(c=>!i.has(c.id));if(s.length>0){let c=[...r.transactions,...s];localStorage.setItem(this.TRANSACTION_KEY,JSON.stringify(c)),o=s.length}}return{addedCustomers:e,addedTransactions:o}}static \u0275fac=function(e){return new(e||t)};static \u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})};function hr(t,n){if(t&1&&(l(0,"mat-icon"),m(1),u()),t&2){let e=me();dn("icon-"+(e.data.iconColor||"primary")),g(),Y(e.data.icon)}}var ae=class t{dialogRef=p(Bn);data=p(Un);onClose(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=K({type:t,selectors:[["app-info-dialog"]],decls:9,vars:4,consts:[[1,"dialog-header"],[3,"class",4,"ngIf"],["mat-dialog-title",""],[3,"innerHTML"],["align","end"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,o){e&1&&(l(0,"div",0),W(1,hr,2,3,"mat-icon",1),l(2,"h2",2),m(3),u()(),l(4,"mat-dialog-content"),R(5,"p",3),u(),l(6,"mat-dialog-actions",4)(7,"button",5),A("click",function(){return o.onClose()}),m(8),u()()),e&2&&(g(),P("ngIf",o.data.icon),g(2),Y(o.data.title),g(2),P("innerHTML",o.data.message,qt),g(3),Y(o.data.buttonText||"OK"))},dependencies:[ne,te,Fe,$n,Kn,zn,je,Yn,ze,$e],styles:[".dialog-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:.5rem;padding:1.25rem 1.5rem 0}h2[_ngcontent-%COMP%]{margin:0}mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px}.icon-primary[_ngcontent-%COMP%]{color:var(--primary-color)}.icon-warn[_ngcontent-%COMP%]{color:var(--error-color)}.icon-accent[_ngcontent-%COMP%]{color:var(--accent-color)}.icon-success[_ngcontent-%COMP%]{color:var(--success-color)}mat-dialog-content[_ngcontent-%COMP%]{padding-top:1rem!important;min-width:300px;max-width:400px}p[_ngcontent-%COMP%]{margin:0;color:var(--text-secondary);line-height:1.6;white-space:pre-line}"]})};function gr(t,n){t&1&&(l(0,"div",17)(1,"div",18)(2,"span",19),m(3,"receipt_long"),u(),l(4,"h2"),m(5,"Select a Customer"),u(),l(6,"p"),m(7,"Click on a customer to view their transactions."),u()()())}var Ge=class t{router=p(Ae);themeService=p(Ye);localStorageService=p(fe);dialog=p(Ne);url=ke(this.router.events.pipe(I(n=>n instanceof _n),C(()=>this.router.url)),{initialValue:this.router.url});showListOnMobile=mn(()=>!this.url().includes("/customer/"));handleRefresh(){window.location.reload()}exportData(){let n=this.localStorageService.getFullData(),e=JSON.stringify(n,null,2),o=new Blob([e],{type:"application/json"}),r=window.URL.createObjectURL(o),i=document.createElement("a");i.href=r,i.download=`khatabook_backup_${new Date().toISOString().split("T")[0]}.json`,i.click(),window.URL.revokeObjectURL(r)}importData(n){let e=n.target;if(!e.files||e.files.length===0)return;let o=e.files[0],r=new FileReader;r.onload=i=>{try{let s=i.target?.result,c=JSON.parse(s);if(c.customers||c.transactions){let h=this.localStorageService.importFullData(c);h.addedCustomers===0&&h.addedTransactions===0?this.dialog.open(ae,{data:{title:"No New Data",message:"All items in the backup already exist in your current data.",icon:"info",iconColor:"primary"}}):this.dialog.open(ae,{data:{title:"Import Successful!",message:`Added:
\u2022 ${h.addedCustomers} new customer(s)
\u2022 ${h.addedTransactions} new transaction(s)

The page will now reload to apply changes.`,icon:"check_circle",iconColor:"success"}}).afterClosed().subscribe(()=>window.location.reload())}else this.dialog.open(ae,{data:{title:"Invalid File",message:"The selected file is not a valid Khatabook backup.",icon:"error",iconColor:"warn"}})}catch{this.dialog.open(ae,{data:{title:"Error",message:"Failed to parse the backup file. Please ensure it is a valid JSON file.",icon:"error",iconColor:"warn"}})}},r.readAsText(o),e.value=""}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=K({type:t,selectors:[["app-dashboard"]],decls:42,vars:10,consts:[["settingsMenu","matMenu"],["fileInput",""],[3,"refresh","scrollable"],[1,"app-layout"],[1,"app-header"],[1,"container"],[1,"brand"],["src","icons/icon-192x192.png","alt","Logo",1,"app-logo"],[1,"actions"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","","routerLink","/reports"],["type","file","accept",".json",2,"display","none",3,"change"],[1,"split-pane","container"],[1,"sidebar"],[1,"main-content"],["class","placeholder-content",4,"ngIf"],[1,"placeholder-content"],[1,"placeholder-msg"],[1,"material-icons","big-icon"]],template:function(e,o){if(e&1){let r=xe();l(0,"app-pull-to-refresh",2),A("refresh",function(){return q(r),ee(o.handleRefresh())}),l(1,"div",3)(2,"header",4)(3,"div",5)(4,"div",6),R(5,"img",7),l(6,"h1"),m(7,"Khatabook"),u()(),l(8,"div",8)(9,"button",9)(10,"mat-icon"),m(11,"settings"),u()(),l(12,"mat-menu",null,0)(14,"button",10),A("click",function(){return q(r),ee(o.themeService.toggleTheme())}),l(15,"mat-icon"),m(16),u(),l(17,"span"),m(18,"Toggle Theme"),u()(),l(19,"button",11)(20,"mat-icon"),m(21,"analytics"),u(),l(22,"span"),m(23,"Reports & Insights"),u()(),l(24,"button",10),A("click",function(){return q(r),ee(o.exportData())}),l(25,"mat-icon"),m(26,"download"),u(),l(27,"span"),m(28,"Export Backup"),u()(),l(29,"button",10),A("click",function(){q(r);let s=st(35);return ee(s.click())}),l(30,"mat-icon"),m(31,"upload"),u(),l(32,"span"),m(33,"Import Backup"),u()(),l(34,"input",12,1),A("change",function(s){return q(r),ee(o.importData(s))}),u()()()()(),l(36,"div",13)(37,"div",14),R(38,"app-customer-list"),u(),l(39,"div",15),R(40,"router-outlet"),W(41,gr,8,0,"div",16),u()()()()}if(e&2){let r=st(13);P("scrollable",!1),g(2),V("mobile-hidden",!o.showListOnMobile()),g(7),P("matMenuTriggerFor",r),g(7),Y(o.themeService.currentTheme()==="dark"?"light_mode":"dark_mode"),g(21),V("mobile-hidden",!o.showListOnMobile()),g(2),V("mobile-hidden",o.showListOnMobile()),g(2),P("ngIf",o.showListOnMobile())}},dependencies:[ne,te,Pe,Sn,Ke,fo,po,uo,mo,ze,$e,je,Vn,He],styles:[".app-layout[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:var(--background-color)}.app-header[_ngcontent-%COMP%]{background:var(--surface-color);border-bottom:1px solid var(--border-color);flex-shrink:0;padding:.75rem 1rem;height:60px;box-sizing:border-box}.app-header[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.app-header[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.app-header[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%]   .app-logo[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:6px;box-shadow:0 2px 4px #0000001a}.app-header[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .brand[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600;color:var(--primary-color)}.app-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;color:var(--primary-color)}.split-pane[_ngcontent-%COMP%]{flex:1;display:flex;overflow:hidden;padding:0;max-width:100%!important;margin:0}.sidebar[_ngcontent-%COMP%]{width:100%;height:100%;background:var(--surface-color)}@media(min-width:768px){.sidebar[_ngcontent-%COMP%]{min-width:450px;width:32%;flex-shrink:0}}.main-content[_ngcontent-%COMP%]{width:100%;height:100%;background:var(--surface-color);display:flex;flex-direction:column}@media(min-width:768px){.main-content[_ngcontent-%COMP%]{flex:1;border-left:1px solid var(--border-color);overflow:hidden}}@media(max-width:767px){.mobile-hidden[_ngcontent-%COMP%]{display:none!important}}.placeholder-content[_ngcontent-%COMP%]{display:none}@media(min-width:768px){.placeholder-content[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column;align-items:center;justify-content:center;color:var(--text-secondary);text-align:center}.placeholder-content[_ngcontent-%COMP%]   .big-icon[_ngcontent-%COMP%]{font-size:4rem;color:var(--primary-light);margin-bottom:1rem;opacity:.5}.placeholder-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:.5rem}}"]})};var Co=[{path:"",component:Ge,children:[{path:"customer/:id",loadComponent:()=>import("./chunk-K5HS3NVR.js").then(t=>t.CustomerLedgerComponent)}]},{path:"reports",loadComponent:()=>import("./chunk-FP3I3QGH.js").then(t=>t.ReportsComponent)}];var mt="Service workers are disabled or not supported by this browser",he=class{serviceWorker;worker;registration;events;constructor(n,e){if(this.serviceWorker=n,!n)this.worker=this.events=this.registration=new H(o=>o.error(new G(5601,!1)));else{let o=null,r=new ce;this.worker=new H(a=>(o!==null&&a.next(o),r.subscribe(b=>a.next(b))));let i=()=>{let{controller:a}=n;a!==null&&(o=a,r.next(o))};n.addEventListener("controllerchange",i),i(),this.registration=this.worker.pipe(X(()=>n.getRegistration().then(a=>{if(!a)throw new G(5601,!1);return a})));let s=new ce;this.events=s.asObservable();let c=a=>{let{data:b}=a;b?.type&&s.next(b)};n.addEventListener("message",c),e?.get(it,null,{optional:!0})?.onDestroy(()=>{n.removeEventListener("controllerchange",i),n.removeEventListener("message",c)})}}postMessage(n,e){return new Promise(o=>{this.worker.pipe(z(1)).subscribe(r=>{r.postMessage(D({action:n},e)),o()})})}postMessageWithOperation(n,e,o){let r=this.waitForOperationCompleted(o),i=this.postMessage(n,e);return Promise.all([i,r]).then(([,s])=>s)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(n){let e;return typeof n=="string"?e=o=>o.type===n:e=o=>n.includes(o.type),this.events.pipe(I(e))}nextEventOfType(n){return this.eventsOfType(n).pipe(z(1))}waitForOperationCompleted(n){return new Promise((e,o)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(I(r=>r.nonce===n),z(1),C(r=>{if(r.result!==void 0)return r.result;throw new Error(r.error)})).subscribe({next:e,error:o})})}get isEnabled(){return!!this.serviceWorker}},vr=(()=>{class t{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new ce;constructor(e){if(this.sw=e,!e.isEnabled){this.messages=Z,this.notificationClicks=Z,this.notificationCloses=Z,this.pushSubscriptionChanges=Z,this.subscription=Z;return}this.messages=this.sw.eventsOfType("PUSH").pipe(C(r=>r.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(C(r=>r.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(C(r=>r.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(C(r=>r.data)),this.pushManager=this.sw.registration.pipe(C(r=>r.pushManager));let o=this.pushManager.pipe(X(r=>r.getSubscription()));this.subscription=new H(r=>{let i=o.subscribe(r),s=this.subscriptionChanges.subscribe(r);return()=>{i.unsubscribe(),s.unsubscribe()}})}requestSubscription(e){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(mt));let o={userVisibleOnly:!0},r=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),i=new Uint8Array(new ArrayBuffer(r.length));for(let s=0;s<r.length;s++)i[s]=r.charCodeAt(s);return o.applicationServerKey=i,new Promise((s,c)=>{this.pushManager.pipe(X(h=>h.subscribe(o)),z(1)).subscribe({next:h=>{this.subscriptionChanges.next(h),s(h)},error:c})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(mt));let e=o=>{if(o===null)throw new G(5602,!1);return o.unsubscribe().then(r=>{if(!r)throw new G(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((o,r)=>{this.subscription.pipe(z(1),X(e)).subscribe({next:o,error:r})})}decodeBase64(e){return atob(e)}static \u0275fac=function(o){return new(o||t)(S(he))};static \u0275prov=E({token:t,factory:t.\u0275fac})}return t})(),yr=(()=>{class t{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(e){if(this.sw=e,!e.isEnabled){this.versionUpdates=Z,this.unrecoverable=Z;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(mt));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;let e=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new G(5601,!1));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}static \u0275fac=function(o){return new(o||t)(S(he))};static \u0275prov=E({token:t,factory:t.\u0275fac})}return t})(),_o=new j("");function Cr(){let t=p(Me);if(!("serviceWorker"in navigator&&t.enabled!==!1))return;let n=p(_o),e=p(pe),o=p(it);e.runOutsideAngular(()=>{let r=navigator.serviceWorker,i=()=>r.controller?.postMessage({action:"INITIALIZE"});r.addEventListener("controllerchange",i),o.onDestroy(()=>{r.removeEventListener("controllerchange",i)})}),e.runOutsideAngular(()=>{let r,{registrationStrategy:i}=t;if(typeof i=="function")r=new Promise(s=>i().subscribe(()=>s()));else{let[s,...c]=(i||"registerWhenStable:30000").split(":");switch(s){case"registerImmediately":r=Promise.resolve();break;case"registerWithDelay":r=bo(+c[0]||0);break;case"registerWhenStable":r=Promise.race([o.whenStable(),bo(+c[0])]);break;default:throw new G(5600,!1)}}r.then(()=>{o.destroyed||navigator.serviceWorker.register(n,{scope:t.scope,updateViaCache:t.updateViaCache,type:t.type}).catch(s=>console.error(Yt(5604,!1)))})})}function bo(t){return new Promise(n=>setTimeout(n,t))}function br(){let t=p(Me),n=p(Ee),e=!0;return new he(e&&t.enabled!==!1?navigator.serviceWorker:void 0,n)}var Me=class{enabled;updateViaCache;type;scope;registrationStrategy};function So(t,n={}){return Q([vr,yr,{provide:_o,useValue:t},{provide:Me,useValue:n},{provide:he,useFactory:br},on(Cr)])}var Or={dispatch:!0,functional:!1,useEffectsErrorHandler:!0},We="__@ngrx/effects_create__";function ge(t,n={}){let e=n.functional?t:t(),o=D(D({},Or),n);return Object.defineProperty(e,We,{value:o}),e}function _r(t){return Object.getOwnPropertyNames(t).filter(o=>t[o]&&t[o].hasOwnProperty(We)?t[o][We].hasOwnProperty("dispatch"):!1).map(o=>{let r=t[o][We];return D({propertyName:o},r)})}function Sr(t){return _r(t)}function Eo(t){return Object.getPrototypeOf(t)}function Er(t){return!!t.constructor&&t.constructor.name!=="Object"&&t.constructor.name!=="Function"}function To(t){return typeof t=="function"}function Tr(t){return t.filter(To)}function wr(t,n,e){let o=Eo(t),i=!!o&&o.constructor.name!=="Object"?o.constructor.name:null,s=Sr(t).map(({propertyName:c,dispatch:h,useEffectsErrorHandler:a})=>{let b=typeof t[c]=="function"?t[c]():t[c],d=a?e(b,n):b;return h===!1?d.pipe(jt()):d.pipe(Ut()).pipe(C(T=>({effect:t[c],notification:T,propertyName:c,sourceName:i,sourceInstance:t})))});return de(...s)}var Ir=10;function wo(t,n,e=Ir){return t.pipe(ie(o=>(n&&n.handleError(o),e<=1?t:wo(t,n,e-1))))}var Io=(()=>{class t extends H{constructor(e){super(),e&&(this.source=e)}lift(e){let o=new t;return o.source=this,o.operator=e,o}static{this.\u0275fac=function(o){return new(o||t)(S(Re))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function ve(...t){return I(n=>t.some(e=>typeof e=="string"?e===n.type:e.type===n.type))}var xr=new j("@ngrx/effects Effects Error Handler",{providedIn:"root",factory:()=>wo}),Pr="@ngrx/effects/init",Ar=Tn(Pr);function kr(t,n){if(t.notification.kind==="N"){let e=t.notification.value;!Dr(e)&&n.handleError(new Error(`Effect ${Rr(t)} dispatched an invalid action: ${Nr(e)}`))}}function Dr(t){return typeof t!="function"&&t&&t.type&&typeof t.type=="string"}function Rr({propertyName:t,sourceInstance:n,sourceName:e}){let o=typeof n[t]=="function";return!!e?`"${e}.${String(t)}${o?"()":""}"`:`"${String(t)}()"`}function Nr(t){try{return JSON.stringify(t)}catch{return t}}var Fr="ngrxOnIdentifyEffects";function jr(t){return ft(t,Fr)}var Lr="ngrxOnRunEffects";function Br(t){return ft(t,Lr)}var Ur="ngrxOnInitEffects";function $r(t){return ft(t,Ur)}function ft(t,n){return t&&n in t&&typeof t[n]=="function"}var xo=(()=>{class t extends ce{constructor(e,o){super(),this.errorHandler=e,this.effectsErrorHandler=o}addEffects(e){this.next(e)}toActions(){return this.pipe(ot(e=>Er(e)?Eo(e):e),le(e=>e.pipe(ot(zr))),le(e=>{let o=e.pipe(Bt(i=>Kr(this.errorHandler,this.effectsErrorHandler)(i)),C(i=>(kr(i,this.errorHandler),i.notification)),I(i=>i.kind==="N"&&i.value!=null),Lt()),r=e.pipe(z(1),I($r),C(i=>i.ngrxOnInitEffects()));return de(o,r)}))}static{this.\u0275fac=function(o){return new(o||t)(S(we),S(xr))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function zr(t){return jr(t)?t.ngrxOnIdentifyEffects():""}function Kr(t,n){return e=>{let o=wr(e,t,n);return Br(e)?e.ngrxOnRunEffects(o):o}}var Vr=(()=>{class t{get isStarted(){return!!this.effectsSubscription}constructor(e,o){this.effectSources=e,this.store=o,this.effectsSubscription=null}start(){this.effectsSubscription||(this.effectsSubscription=this.effectSources.toActions().subscribe(this.store))}ngOnDestroy(){this.effectsSubscription&&(this.effectsSubscription.unsubscribe(),this.effectsSubscription=null)}static{this.\u0275fac=function(o){return new(o||t)(S(xo),S(oe))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Po(...t){let n=t.flat(),e=Tr(n);return Q([e,Ht(()=>{p(In),p(xn,{optional:!0});let o=p(Vr),r=p(xo),i=!o.isStarted;i&&o.start();for(let s of n){let c=To(s)?p(s):s;r.addEffects(c)}i&&p(oe).dispatch(Ar())})])}var _e="PERFORM_ACTION",Yr="REFRESH",Fo="RESET",jo="ROLLBACK",Lo="COMMIT",Bo="SWEEP",Uo="TOGGLE_ACTION",Hr="SET_ACTIONS_ACTIVE",$o="JUMP_TO_STATE",zo="JUMP_TO_ACTION",wt="IMPORT_STATE",Ko="LOCK_CHANGES",Vo="PAUSE_RECORDING",ye=class{constructor(n,e){if(this.action=n,this.timestamp=e,this.type=_e,typeof n.type>"u")throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?')}},ht=class{constructor(){this.type=Yr}},gt=class{constructor(n){this.timestamp=n,this.type=Fo}},vt=class{constructor(n){this.timestamp=n,this.type=jo}},yt=class{constructor(n){this.timestamp=n,this.type=Lo}},Ct=class{constructor(){this.type=Bo}},bt=class{constructor(n){this.id=n,this.type=Uo}};var Mt=class{constructor(n){this.index=n,this.type=$o}},Ot=class{constructor(n){this.actionId=n,this.type=zo}},_t=class{constructor(n){this.nextLiftedState=n,this.type=wt}},St=class{constructor(n){this.status=n,this.type=Ko}},Et=class{constructor(n){this.status=n,this.type=Vo}};var Qe=new j("@ngrx/store-devtools Options"),Ao=new j("@ngrx/store-devtools Initial Config");function Yo(){return null}var Gr="NgRx Store DevTools";function Wr(t){let n={maxAge:!1,monitor:Yo,actionSanitizer:void 0,stateSanitizer:void 0,name:Gr,serialize:!1,logOnly:!1,autoPause:!1,trace:!1,traceLimit:75,features:{pause:!0,lock:!0,persist:!0,export:!0,import:"custom",jump:!0,skip:!0,reorder:!0,dispatch:!0,test:!0},connectInZone:!1},e=typeof t=="function"?t():t,o=e.logOnly?{pause:!0,export:!0,test:!0}:!1,r=e.features||o||n.features;r.import===!0&&(r.import="custom");let i=Object.assign({},n,{features:r},e);if(i.maxAge&&i.maxAge<2)throw new Error(`Devtools 'maxAge' cannot be less than 2, got ${i.maxAge}`);return i}function ko(t,n){return t.filter(e=>n.indexOf(e)<0)}function Ho(t){let{computedStates:n,currentStateIndex:e}=t;if(e>=n.length){let{state:r}=n[n.length-1];return r}let{state:o}=n[e];return o}function Oe(t){return new ye(t,+Date.now())}function Jr(t,n){return Object.keys(n).reduce((e,o)=>{let r=Number(o);return e[r]=Go(t,n[r],r),e},{})}function Go(t,n,e){return re(D({},n),{action:t(n.action,e)})}function Zr(t,n){return n.map((e,o)=>({state:Wo(t,e.state,o),error:e.error}))}function Wo(t,n,e){return t(n,e)}function Jo(t){return t.predicate||t.actionsSafelist||t.actionsBlocklist}function Xr(t,n,e,o){let r=[],i={},s=[];return t.stagedActionIds.forEach((c,h)=>{let a=t.actionsById[c];a&&(h&&It(t.computedStates[h],a,n,e,o)||(i[c]=a,r.push(c),s.push(t.computedStates[h])))}),re(D({},t),{stagedActionIds:r,actionsById:i,computedStates:s})}function It(t,n,e,o,r){let i=e&&!e(t,n.action),s=o&&!n.action.type.match(o.map(h=>Do(h)).join("|")),c=r&&n.action.type.match(r.map(h=>Do(h)).join("|"));return i||s||c}function Do(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Zo(t){return{ngZone:t?p(pe):null,connectInZone:t}}var qe=(()=>{class t extends De{static{this.\u0275fac=(()=>{let e;return function(r){return(e||(e=Xt(t)))(r||t)}})()}static{this.\u0275prov=E({token:t,factory:t.\u0275fac})}}return t})(),Je={START:"START",DISPATCH:"DISPATCH",STOP:"STOP",ACTION:"ACTION"},Tt=new j("@ngrx/store-devtools Redux Devtools Extension"),Xo=(()=>{class t{constructor(e,o,r){this.config=o,this.dispatcher=r,this.zoneConfig=Zo(this.config.connectInZone),this.devtoolsExtension=e,this.createActionStreams()}notify(e,o){if(this.devtoolsExtension)if(e.type===_e){if(o.isLocked||o.isPaused)return;let r=Ho(o);if(Jo(this.config)&&It(r,e,this.config.predicate,this.config.actionsSafelist,this.config.actionsBlocklist))return;let i=this.config.stateSanitizer?Wo(this.config.stateSanitizer,r,o.currentStateIndex):r,s=this.config.actionSanitizer?Go(this.config.actionSanitizer,e,o.nextActionId):e;this.sendToReduxDevtools(()=>this.extensionConnection.send(s,i))}else{let r=re(D({},o),{stagedActionIds:o.stagedActionIds,actionsById:this.config.actionSanitizer?Jr(this.config.actionSanitizer,o.actionsById):o.actionsById,computedStates:this.config.stateSanitizer?Zr(this.config.stateSanitizer,o.computedStates):o.computedStates});this.sendToReduxDevtools(()=>this.devtoolsExtension.send(null,r,this.getExtensionConfig(this.config)))}}createChangesObservable(){return this.devtoolsExtension?new H(e=>{let o=this.zoneConfig.connectInZone?this.zoneConfig.ngZone.runOutsideAngular(()=>this.devtoolsExtension.connect(this.getExtensionConfig(this.config))):this.devtoolsExtension.connect(this.getExtensionConfig(this.config));return this.extensionConnection=o,o.init(),o.subscribe(r=>e.next(r)),o.unsubscribe}):At}createActionStreams(){let e=this.createChangesObservable().pipe(zt()),o=e.pipe(I(a=>a.type===Je.START)),r=e.pipe(I(a=>a.type===Je.STOP)),i=e.pipe(I(a=>a.type===Je.DISPATCH),C(a=>this.unwrapAction(a.payload)),Nt(a=>a.type===wt?this.dispatcher.pipe(I(b=>b.type===lt),Dt(1e3),Ft(1e3),C(()=>a),ie(()=>F(a)),z(1)):F(a))),c=e.pipe(I(a=>a.type===Je.ACTION),C(a=>this.unwrapAction(a.payload))).pipe(Se(r)),h=i.pipe(Se(r));this.start$=o.pipe(Se(r)),this.actions$=this.start$.pipe(X(()=>c)),this.liftedActions$=this.start$.pipe(X(()=>h))}unwrapAction(e){return typeof e=="string"?(0,eval)(`(${e})`):e}getExtensionConfig(e){let o={name:e.name,features:e.features,serialize:e.serialize,autoPause:e.autoPause??!1,trace:e.trace??!1,traceLimit:e.traceLimit??75};return e.maxAge!==!1&&(o.maxAge=e.maxAge),o}sendToReduxDevtools(e){try{e()}catch(o){console.warn("@ngrx/store-devtools: something went wrong inside the redux devtools",o)}}static{this.\u0275fac=function(o){return new(o||t)(S(Tt),S(Qe),S(qe))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac})}}return t})(),Xe={type:ct},Qr="@ngrx/store-devtools/recompute",qr={type:Qr};function Qo(t,n,e,o,r){if(o)return{state:e,error:"Interrupted by an error up the chain"};let i=e,s;try{i=t(e,n)}catch(c){s=c.toString(),r.handleError(c)}return{state:i,error:s}}function Ze(t,n,e,o,r,i,s,c,h){if(n>=t.length&&t.length===i.length)return t;let a=t.slice(0,n),b=i.length-(h?1:0);for(let d=n;d<b;d++){let y=i[d],T=r[y].action,v=a[d-1],f=v?v.state:o,B=v?v.error:void 0,U=s.indexOf(y)>-1?v:Qo(e,T,f,B,c);a.push(U)}return h&&a.push(t[t.length-1]),a}function ei(t,n){return{monitorState:n(void 0,{}),nextActionId:1,actionsById:{0:Oe(Xe)},stagedActionIds:[0],skippedActionIds:[],committedState:t,currentStateIndex:0,computedStates:[],isLocked:!1,isPaused:!1}}function ti(t,n,e,o,r={}){return i=>(s,c)=>{let{monitorState:h,actionsById:a,nextActionId:b,stagedActionIds:d,skippedActionIds:y,committedState:T,currentStateIndex:v,computedStates:f,isLocked:B,isPaused:w}=s||n;s||(a=Object.create(a));function U(_){let O=_,J=d.slice(1,O+1);for(let N=0;N<J.length;N++)if(f[N+1].error){O=N,J=d.slice(1,O+1);break}else delete a[J[N]];y=y.filter(N=>J.indexOf(N)===-1),d=[0,...d.slice(O+1)],T=f[O].state,f=f.slice(O),v=v>O?v-O:0}function $(){a={0:Oe(Xe)},b=1,d=[0],y=[],T=f[v].state,v=0,f=[]}let M=0;switch(c.type){case Ko:{B=c.status,M=1/0;break}case Vo:{w=c.status,w?(d=[...d,b],a[b]=new ye({type:"@ngrx/devtools/pause"},+Date.now()),b++,M=d.length-1,f=f.concat(f[f.length-1]),v===d.length-2&&v++,M=1/0):$();break}case Fo:{a={0:Oe(Xe)},b=1,d=[0],y=[],T=t,v=0,f=[];break}case Lo:{$();break}case jo:{a={0:Oe(Xe)},b=1,d=[0],y=[],v=0,f=[];break}case Uo:{let{id:_}=c;y.indexOf(_)===-1?y=[_,...y]:y=y.filter(J=>J!==_),M=d.indexOf(_);break}case Hr:{let{start:_,end:O,active:J}=c,N=[];for(let nt=_;nt<O;nt++)N.push(nt);J?y=ko(y,N):y=[...y,...N],M=d.indexOf(_);break}case $o:{v=c.index,M=1/0;break}case zo:{let _=d.indexOf(c.actionId);_!==-1&&(v=_),M=1/0;break}case Bo:{d=ko(d,y),y=[],v=Math.min(v,d.length-1);break}case _e:{if(B)return s||n;if(w||s&&It(s.computedStates[v],c,r.predicate,r.actionsSafelist,r.actionsBlocklist)){let O=f[f.length-1];f=[...f.slice(0,-1),Qo(i,c.action,O.state,O.error,e)],M=1/0;break}r.maxAge&&d.length===r.maxAge&&U(1),v===d.length-1&&v++;let _=b++;a[_]=c,d=[...d,_],M=d.length-1;break}case wt:{({monitorState:h,actionsById:a,nextActionId:b,stagedActionIds:d,skippedActionIds:y,committedState:T,currentStateIndex:v,computedStates:f,isLocked:B,isPaused:w}=c.nextLiftedState);break}case ct:{M=0,r.maxAge&&d.length>r.maxAge&&(f=Ze(f,M,i,T,a,d,y,e,w),U(d.length-r.maxAge),M=1/0);break}case lt:{if(f.filter(O=>O.error).length>0)M=0,r.maxAge&&d.length>r.maxAge&&(f=Ze(f,M,i,T,a,d,y,e,w),U(d.length-r.maxAge),M=1/0);else{if(!w&&!B){v===d.length-1&&v++;let O=b++;a[O]=new ye(c,+Date.now()),d=[...d,O],M=d.length-1,f=Ze(f,M,i,T,a,d,y,e,w)}f=f.map(O=>re(D({},O),{state:i(O.state,qr)})),v=d.length-1,r.maxAge&&d.length>r.maxAge&&U(d.length-r.maxAge),M=1/0}break}default:{M=1/0;break}}return f=Ze(f,M,i,T,a,d,y,e,w),h=o(h,c),{monitorState:h,actionsById:a,nextActionId:b,stagedActionIds:d,skippedActionIds:y,committedState:T,currentStateIndex:v,computedStates:f,isLocked:B,isPaused:w}}}var Ro=(()=>{class t{constructor(e,o,r,i,s,c,h,a){let b=ei(h,a.monitor),d=ti(h,b,c,a.monitor,a),y=de(de(o.asObservable().pipe(Kt(1)),i.actions$).pipe(C(Oe)),e,i.liftedActions$).pipe(kt(Pt)),T=r.pipe(C(d)),v=Zo(a.connectInZone),f=new xt(1);this.liftedStateSubscription=y.pipe(ue(T),No(v),$t(({state:U},[$,M])=>{let _=M(U,$);return $.type!==_e&&Jo(a)&&(_=Xr(_,a.predicate,a.actionsSafelist,a.actionsBlocklist)),i.notify($,_),{state:_,action:$}},{state:b,action:null})).subscribe(({state:U,action:$})=>{if(f.next(U),$.type===_e){let M=$.action;s.next(M)}}),this.extensionStartSubscription=i.start$.pipe(No(v)).subscribe(()=>{this.refresh()});let B=f.asObservable(),w=B.pipe(C(Ho));Object.defineProperty(w,"state",{value:ke(w,{manualCleanup:!0,requireSync:!0})}),this.dispatcher=e,this.liftedState=B,this.state=w}ngOnDestroy(){this.liftedStateSubscription.unsubscribe(),this.extensionStartSubscription.unsubscribe()}dispatch(e){this.dispatcher.next(e)}next(e){this.dispatcher.next(e)}error(e){}complete(){}performAction(e){this.dispatch(new ye(e,+Date.now()))}refresh(){this.dispatch(new ht)}reset(){this.dispatch(new gt(+Date.now()))}rollback(){this.dispatch(new vt(+Date.now()))}commit(){this.dispatch(new yt(+Date.now()))}sweep(){this.dispatch(new Ct)}toggleAction(e){this.dispatch(new bt(e))}jumpToAction(e){this.dispatch(new Ot(e))}jumpToState(e){this.dispatch(new Mt(e))}importState(e){this.dispatch(new _t(e))}lockChanges(e){this.dispatch(new St(e))}pauseRecording(e){this.dispatch(new Et(e))}static{this.\u0275fac=function(o){return new(o||t)(S(qe),S(De),S(Pn),S(Xo),S(Re),S(we),S(wn),S(Qe))}}static{this.\u0275prov=E({token:t,factory:t.\u0275fac})}}return t})();function No({ngZone:t,connectInZone:n}){return e=>n?new H(o=>e.subscribe({next:r=>t.run(()=>o.next(r)),error:r=>t.run(()=>o.error(r)),complete:()=>t.run(()=>o.complete())})):e}var ni=new j("@ngrx/store-devtools Is Devtools Extension or Monitor Present");function oi(t,n){return!!t||n.monitor!==Yo}function ri(){let t="__REDUX_DEVTOOLS_EXTENSION__";return typeof window=="object"&&typeof window[t]<"u"?window[t]:null}function ii(t){return t.state}function qo(t={}){return Q([Xo,qe,Ro,{provide:Ao,useValue:t},{provide:ni,deps:[Tt,Qe],useFactory:oi},{provide:Tt,useFactory:ri},{provide:Qe,deps:[Ao],useFactory:Wr},{provide:kn,deps:[Ro],useFactory:ii},{provide:An,useExisting:qe}])}var et=class t{actions$=p(Io);localStorageService=p(fe);store=p(oe);loadCustomers$=ge(()=>this.actions$.pipe(ve(Le),le(()=>this.localStorageService.getCustomers().pipe(C(n=>Gn({customers:n})),ie(n=>F(Wn({error:n})))))));loadTransactions$=ge(()=>this.actions$.pipe(ve(Ue),le(()=>this.localStorageService.getTransactions().pipe(C(n=>Xn({transactions:n})),ie(n=>F(Qn({error:n})))))));persistCustomers$=ge(()=>this.actions$.pipe(ve(Be,Zn,Jn),ue(this.store.select(oo)),rt(([n,e])=>{this.localStorageService.saveCustomers(e).subscribe()})),{dispatch:!1});persistTransactions$=ge(()=>this.actions$.pipe(ve(dt,eo,qn),ue(this.store.select(io)),rt(([n,e])=>{this.localStorageService.saveTransactions(e).subscribe()})),{dispatch:!1});updateCustomerBalance$=ge(()=>this.actions$.pipe(ve(dt),ue(this.store.select(ro)),C(([{transaction:n},e])=>{let o=e[n.customerId];if(o){let r=o.currentBalance;n.type==="GAVE"?r+=n.amount:r-=n.amount;let i=re(D({},o),{currentBalance:r,lastUpdated:new Date().toISOString()});return{type:"NO_OP"}}return{type:"NO_OP"}})),{dispatch:!1});static \u0275fac=function(e){return new(e||t)};static \u0275prov=E({token:t,factory:t.\u0275fac})};function si(t){let n=t,e=Math.floor(Math.abs(t)),o=t.toString().replace(/^[^.]*\.?/,"").length;return e===1&&o===0?1:5}var er=["en-IN",[["a","p"],["am","pm"]],[["am","pm"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],void 0,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],void 0,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[0,0],["dd/MM/yy","d MMM y","d MMMM y","EEEE, d MMMM y"],["h:mm\u202Fa","h:mm:ss\u202Fa","h:mm:ss\u202Fa z","h:mm:ss\u202Fa zzzz"],["{1}, {0}",void 0,void 0,void 0],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##,##0.###","#,##,##0%","\xA4#,##,##0.00","#E0"],"INR","\u20B9","Indian Rupee",{JPY:["JP\xA5","\xA5"]},"ltr",si];Cn(er);var tr={providers:[{provide:pn,useValue:"en-IN"},Wt(),En(Co),Dn({customers:to,transactions:no}),Po([et]),qo({maxAge:25,logOnly:!at()}),yo(),ho(),So("ngsw-worker.js",{enabled:!at(),registrationStrategy:"registerWhenStable:30000"}),vo(go())]};var tt=class t{title=Ie("khatabook");static \u0275fac=function(e){return new(e||t)};static \u0275cmp=K({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(e,o){e&1&&R(0,"router-outlet")},dependencies:[Pe],encapsulation:2})};Mn(tt,tr).catch(t=>console.error(t));
